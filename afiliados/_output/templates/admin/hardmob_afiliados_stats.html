<xf:title>{{ phrase('hardmob_afiliados_stats_nav') }}</xf:title>

<div class="block">
    <div class="block-container">
        <div class="block-header">
            <div class="block-header-controls">
                <xf:form action="{{ link('affiliates/tools/stats') }}" class="inputGroup">
                    <xf:select name="period" value="{$filters.period}" class="input">
                        <xf:option value="day">Hoje</xf:option>
                        <xf:option value="week">Esta Semana</xf:option>
                        <xf:option value="month" selected="true">Este Mês</xf:option>
                        <xf:option value="year">Este Ano</xf:option>
                    </xf:select>
                    
                    <xf:select name="store_id" value="{$filters.store_id}" class="input">
                        <xf:option value="">Todas as Lojas</xf:option>
                        <xf:foreach loop="$stores" value="$store">
                            <xf:option value="{$store.store_id}">{$store.name}</xf:option>
                        </xf:foreach>
                    </xf:select>
                    
                    <xf:button type="submit" class="button--primary">Filtrar</xf:button>
                </xf:form>
            </div>
        </div>
        
        <div class="block-body">
            <xf:if is="$stats.store_stats">
                <h3>Estatísticas por Loja</h3>
                <div class="structItemContainer">
                    <xf:foreach loop="$stats.store_stats" value="$stat">
                        <div class="structItem">
                            <div class="structItem-cell structItem-cell--main">
                                <div class="structItem-title">{$stat.store_name}</div>
                            </div>
                            <div class="structItem-cell">
                                <strong>{$stat.total_clicks}</strong> cliques
                            </div>
                            <div class="structItem-cell">
                                <strong>{$stat.unique_users}</strong> usuários únicos
                            </div>
                        </div>
                    </xf:foreach>
                </div>
                
                <hr />
                
                <h3>Top Produtos</h3>
                <div class="structItemContainer">
                    <xf:foreach loop="$stats.top_slugs" value="$slug" counter="$i">
                        <xf:if is="$i <= 10">
                            <div class="structItem">
                                <div class="structItem-cell structItem-cell--main">
                                    <div class="structItem-title">{$slug.slug}</div>
                                    <div class="structItem-minor">{$slug.store_name}</div>
                                </div>
                                <div class="structItem-cell">
                                    <strong>{$slug.click_count}</strong> cliques
                                </div>
                            </div>
                        </xf:if>
                    </xf:foreach>
                </div>
            <xf:else />
                <div class="blockMessage">
                    Nenhuma estatística disponível para o período selecionado.
                </div>
            </xf:if>
        </div>
    </div>
</div>
